<template>
  <div class="page-container how-it-works-page" dir="ltr">
    <section class="how-it-works-hero">
      <div class="how-it-works-hero__content">
        <p class="how-it-works-hero__pill">Platform Guide</p>
        <h1 class="how-it-works-hero__title">How It Works</h1>
        <p class="how-it-works-hero__subtitle">
          Everything you need to know about playing, competing, and creating on TOP-X
        </p>
      </div>
    </section>

    <section class="how-it-works-body fade-in">
      <div class="how-it-works-surface">
        <div class="how-it-works-content">
          <p class="how-it-works-intro">
            TOP-X is a competitive gaming platform where you can play challenges, compete on leaderboards, and create your own games. Whether you're a casual player or a competitive creator, this guide will help you get the most out of the platform.
          </p>

          <!-- Playing Games -->
          <div class="how-it-works-section">
            <h2>1. Playing Games</h2>
            
            <h3>1.1 Discovering Games</h3>
            <p>TOP-X offers several ways to find games that interest you:</p>
            <ul>
              <li><strong>Featured Games:</strong> Curated selections hand-picked by the TOP-X team. These games showcase the best content on the platform and are perfect for new players.</li>
              <li><strong>Hot Games:</strong> Popular games sorted by player count. These are the most active challenges where competition is fierce.</li>
              <li><strong>Official Games:</strong> Games created by TOP-X featuring trending topics, viral challenges, and community favorites.</li>
              <li><strong>Community Games:</strong> User-created games from talented creators. Discover unique challenges and support community creators.</li>
              <li><strong>Search & Filter:</strong> Use the games page to search by name, filter by game type, language, or creator to find exactly what you're looking for.</li>
            </ul>

            <h3>1.2 Game Types Explained</h3>
            <ul>
              <li><strong>Pyramid Games:</strong> Rank items in tiers from best to worst. Perfect for debates like "Top Football Players" or "Best Movies of All Time." Drag and drop items to build your pyramid, then compare with friends.</li>
              <li><strong>Trivia Challenges:</strong> Answer questions across various categories to test your knowledge. Earn points for correct answers and compete for high scores on leaderboards.</li>
              <li><strong>Quiz Games:</strong> Interactive quizzes with multiple choice questions. See how your knowledge compares to other players and share your results.</li>
              <li><strong>Zone Reveal Games:</strong> Strategic puzzle games where you reveal zones on a grid. Compete for the fastest completion time or highest score.</li>
              <li><strong>Daily Challenges:</strong> Special game modes that reset every 24 hours, creating fresh competition opportunities with new leaderboards each day.</li>
            </ul>

            <h3>1.3 Playing a Game</h3>
            <p>Playing games on TOP-X is simple:</p>
            <ol>
              <li><strong>Select a Game:</strong> Browse the homepage or games page and click on any game that interests you.</li>
              <li><strong>Read Instructions:</strong> Each game includes instructions explaining how to play. Take a moment to understand the rules and objectives.</li>
              <li><strong>Play:</strong> Complete the game following the on-screen instructions. Most games are quick, taking just a few minutes to complete.</li>
              <li><strong>View Results:</strong> After completing a game, see your score, ranking, and how you compare to other players.</li>
              <li><strong>Share:</strong> Share your results on X, WhatsApp, or other platforms to challenge friends and show off your achievements.</li>
            </ol>
          </div>

          <!-- Competing & Leaderboards -->
          <div class="how-it-works-section">
            <h2>2. Competing & Leaderboards</h2>
            
            <h3>2.1 Understanding Leaderboards</h3>
            <p>Leaderboards are the competitive heart of TOP-X, showing who performs best in each game:</p>
            <ul>
              <li><strong>All-Time Leaderboards:</strong> Show the best players ever for each game. These rankings persist over time, giving you long-term goals to work toward.</li>
              <li><strong>Daily Challenge Leaderboards:</strong> Reset every 24 hours, creating fresh competition. Perfect for players who want regular, new challenges.</li>
              <li><strong>Friend Leaderboards:</strong> Filter leaderboards to show only players you follow, making competition more personal and engaging.</li>
              <li><strong>Real-Time Updates:</strong> Leaderboards update instantly as players submit new scores, so you can see your ranking change in real-time.</li>
            </ul>

            <h3>2.2 Climbing the Rankings</h3>
            <p>To improve your leaderboard position:</p>
            <ul>
              <li><strong>Practice:</strong> Play games multiple times to improve your skills and learn optimal strategies.</li>
              <li><strong>Study Game Mechanics:</strong> Understand how scoring works in each game type. Some games reward speed, others reward accuracy.</li>
              <li><strong>Learn from Top Players:</strong> Check top players' profiles to see their game history and learn from their strategies.</li>
              <li><strong>Focus on Daily Challenges:</strong> Daily challenges offer fresh opportunities to claim top spots, especially if you're new to a game.</li>
            </ul>

            <h3>2.3 Following & Competing with Friends</h3>
            <p>Make competition more personal by following other players:</p>
            <ul>
              <li><strong>Search for Players:</strong> Use the users page to search for friends by username or display name.</li>
              <li><strong>Follow Players:</strong> Click follow on any player's profile to track their activity and compare scores.</li>
              <li><strong>Compare Scores:</strong> View filtered leaderboards showing only players you follow, making it easy to see how you stack up.</li>
              <li><strong>Challenge Friends:</strong> Share your game results and challenge friends directly to beat your scores.</li>
            </ul>
          </div>

          <!-- Creating Games -->
          <div class="how-it-works-section">
            <h2>3. Creating Your Own Games</h2>
            
            <h3>3.1 Getting Started as a Creator</h3>
            <p>To create games on TOP-X, you need to:</p>
            <ol>
              <li><strong>Log In:</strong> Sign in with your X account to access the game builder. The builder is only available to logged-in users.</li>
              <li><strong>Access the Builder:</strong> Click "Build" in the navigation menu or visit the build page directly.</li>
              <li><strong>Choose a Template:</strong> Select from available game templates including trivia, pyramid, quiz, and zone reveal formats.</li>
              <li><strong>Customize Your Game:</strong> Use the step-by-step wizard to configure your game's content, settings, and appearance.</li>
              <li><strong>Publish:</strong> Once satisfied with your game, publish it to make it available to the TOP-X community.</li>
            </ol>

            <h3>3.2 Game Builder Features</h3>
            <p>The TOP-X game builder offers powerful customization options:</p>
            <ul>
              <li><strong>Content Creation:</strong> Add questions, answers, items to rank, or game elements depending on your chosen template.</li>
              <li><strong>Visual Customization:</strong> Customize colors, themes, backgrounds, and branding to match your game's style.</li>
              <li><strong>Game Mechanics:</strong> Configure difficulty, scoring, timers, power-ups, and other gameplay elements.</li>
              <li><strong>Settings:</strong> Control who can play, whether login is required, and how often players can attempt your game.</li>
              <li><strong>Daily Challenges:</strong> Set up daily challenges for your games, creating recurring competitions that reset every 24 hours.</li>
            </ul>

            <h3>3.3 Best Practices for Creators</h3>
            <ul>
              <li><strong>Original Content:</strong> Create games with original questions, rankings, or challenges. While inspiration is welcome, copying entire games is discouraged.</li>
              <li><strong>Clear Instructions:</strong> Provide clear, concise instructions so players understand how to play your game.</li>
              <li><strong>Balanced Difficulty:</strong> Design games that are challenging but achievable. Consider your target audience when setting difficulty.</li>
              <li><strong>Engaging Content:</strong> Create games around trending topics, popular debates, or interesting questions that players want to share.</li>
              <li><strong>Regular Updates:</strong> Keep your games fresh by updating content, adding new questions, or adjusting difficulty based on player feedback.</li>
            </ul>
          </div>

          <!-- Sharing & Social Features -->
          <div class="how-it-works-section">
            <h2>4. Sharing & Social Features</h2>
            
            <h3>4.1 Sharing Your Results</h3>
            <p>Sharing is a core part of the TOP-X experience:</p>
            <ul>
              <li><strong>Automatic Sharing:</strong> After completing a game, use the share button to download your results image and copy pre-written share text.</li>
              <li><strong>Multiple Platforms:</strong> Share on X, WhatsApp, Facebook, Instagram, or any other platform. The share text includes your score and a link to the game.</li>
              <li><strong>Challenge Friends:</strong> Tag friends in your shares to challenge them directly and invite them to beat your score.</li>
              <li><strong>Viral Potential:</strong> Well-designed games with shareable results can go viral, bringing more players to your games.</li>
            </ul>

            <h3>4.2 Building Your Community</h3>
            <ul>
              <li><strong>Follow Players:</strong> Build your network by following players whose games you enjoy or who compete in similar challenges.</li>
              <li><strong>Engage with Creators:</strong> Play community-created games and provide feedback to support creators.</li>
              <li><strong>Create Shareable Content:</strong> Design games that players want to share, increasing visibility and engagement.</li>
              <li><strong>Respond to Feedback:</strong> Monitor player feedback and improve your games based on community suggestions.</li>
            </ul>
          </div>

          <!-- Account & Profile -->
          <div class="how-it-works-section">
            <h2>5. Account & Profile Management</h2>
            
            <h3>5.1 Logging In</h3>
            <p>While you can browse and play some games without logging in, creating an account unlocks the full TOP-X experience:</p>
            <ul>
              <li><strong>X Authentication:</strong> Log in securely using your X account. We use X's OAuth system, so we never see your password.</li>
              <li><strong>Minimal Permissions:</strong> We only request access to your public profile information (username and profile picture). We don't access private posts, DMs, or follow lists.</li>
              <li><strong>Secure Storage:</strong> Your account data is stored securely using Firebase with industry-standard encryption.</li>
            </ul>

            <h3>5.2 Profile Features</h3>
            <p>Your TOP-X profile showcases your gaming achievements:</p>
            <ul>
              <li><strong>Game History:</strong> View all games you've played, scores achieved, and rankings earned.</li>
              <li><strong>Statistics:</strong> See your overall statistics including total games played, favorite games, and best performances.</li>
              <li><strong>Favorites:</strong> Save your favorite games for quick access later.</li>
              <li><strong>Following:</strong> Manage who you follow and see their activity.</li>
              <li><strong>Created Games:</strong> If you're a creator, see all games you've created and their performance metrics.</li>
            </ul>
          </div>

          <!-- Tips & Strategies -->
          <div class="how-it-works-section highlight">
            <h2>6. Tips & Strategies</h2>
            
            <h3>6.1 For Players</h3>
            <ul>
              <li><strong>Start with Featured Games:</strong> Begin with featured games to understand different game types and mechanics.</li>
              <li><strong>Practice Regularly:</strong> Consistent play improves your skills and helps you climb leaderboards.</li>
              <li><strong>Focus on Daily Challenges:</strong> Daily challenges offer fresh opportunities to claim top spots, especially for new players.</li>
              <li><strong>Follow Top Players:</strong> Learn from the best by following top players and studying their game strategies.</li>
              <li><strong>Share Your Wins:</strong> Sharing results helps build your reputation and invites friends to compete.</li>
            </ul>

            <h3>6.2 For Creators</h3>
            <ul>
              <li><strong>Start Simple:</strong> Begin with simple games to learn the builder, then gradually create more complex challenges.</li>
              <li><strong>Test Thoroughly:</strong> Play-test your games multiple times before publishing to ensure they work correctly.</li>
              <li><strong>Engage with Players:</strong> Respond to feedback and update your games based on community suggestions.</li>
              <li><strong>Promote Your Games:</strong> Share your games on X and other platforms to attract players.</li>
              <li><strong>Create Daily Challenges:</strong> Daily challenges keep players coming back and increase engagement with your games.</li>
            </ul>
          </div>

          <!-- Getting Help -->
          <div class="how-it-works-section">
            <h2>7. Getting Help & Support</h2>
            <p>If you need assistance or have questions:</p>
            <ul>
              <li><strong>FAQ Page:</strong> Check our <router-link to="/faq" class="has-text-primary">FAQ page</router-link> for answers to common questions.</li>
              <li><strong>Contact Support:</strong> Email us at <a href="mailto:contact@top-x.co" class="has-text-primary">contact@top-x.co</a> for support, questions, or feedback.</li>
              <li><strong>Follow Updates:</strong> Follow <a href="https://x.com/topxapp" target="_blank" rel="noopener noreferrer" class="has-text-primary">@topxapp</a> on X for platform updates, new features, and community highlights.</li>
              <li><strong>Community Guidelines:</strong> Review our <router-link to="/guidelines" class="has-text-primary">Community Guidelines</router-link> to understand platform rules and expectations.</li>
            </ul>
          </div>
        </div>

        <div class="how-it-works-footer">
          <CustomButton
            type="is-primary is-large"
            label="Start Playing"
            @click="$router.push('/')"
          />
        </div>
      </div>
    </section>
  </div>
</template>

<script setup lang="ts">
import { onMounted, nextTick } from 'vue';
import { useRoute } from 'vue-router';
import { useHead } from '@vueuse/head';
import CustomButton from '@top-x/shared/components/CustomButton.vue';

const route = useRoute();
const baseUrl = 'https://top-x.co';
const canonicalUrl = `${baseUrl}${route.path}`;

useHead(() => ({
  title: 'How It Works - TOP-X',
  meta: [
    {
      name: 'description',
      content: 'Learn how to play games, compete on leaderboards, create your own challenges, and get the most out of the TOP-X gaming platform.',
    },
    {
      name: 'keywords',
      content: 'TOP-X guide, how to play, game creation, leaderboards, competition',
    },
    // Open Graph tags
    {
      property: 'og:title',
      content: 'How It Works - TOP-X',
    },
    {
      property: 'og:description',
      content: 'Learn how to play games, compete on leaderboards, create your own challenges, and get the most out of the TOP-X gaming platform.',
    },
    {
      property: 'og:type',
      content: 'website',
    },
    {
      property: 'og:url',
      content: canonicalUrl,
    },
    {
      property: 'og:site_name',
      content: 'TOP-X',
    },
    // Twitter Card tags
    {
      name: 'twitter:card',
      content: 'summary_large_image',
    },
    {
      name: 'twitter:title',
      content: 'How It Works - TOP-X',
    },
    {
      name: 'twitter:description',
      content: 'Learn how to play games, compete on leaderboards, create your own challenges, and get the most out of the TOP-X gaming platform.',
    },
  ],
  link: [
    {
      rel: 'canonical',
      href: canonicalUrl,
    },
  ],
}));

// Ensure prerender-ready fires after content is fully rendered
onMounted(() => {
  nextTick(() => {
    if (import.meta.env.PROD && (window as any).__PRERENDER_INJECTED) {
      setTimeout(() => {
        document.dispatchEvent(new Event('prerender-ready'));
      }, 500);
    }
  });
});
</script>

<style scoped>
.how-it-works-page {
  display: flex;
  flex-direction: column;
  gap: 4rem;
  direction: ltr;
  text-align: left;
}

.how-it-works-hero {
  position: relative;
  overflow: hidden;
  padding: 6rem 1.5rem 5rem;
  display: flex;
  justify-content: center;
}

.how-it-works-hero__content {
  position: relative;
  width: min(960px, 100%);
  display: flex;
  flex-direction: column;
  gap: 1rem;
  text-align: center;
  align-items: center;
}

.how-it-works-hero__pill {
  display: inline-flex;
  padding: 0.4rem 1.3rem;
  border-radius: 999px;
  background-color: var(--color-primary-bg);
  border: 1px solid var(--color-border-primary);
  color: var(--bulma-primary);
  letter-spacing: 0.12em;
  font-weight: 600;
  text-transform: uppercase;
  font-size: 0.85rem;
}

.how-it-works-hero__title {
  font-size: clamp(2.5rem, 2vw + 2rem, 3.8rem);
  font-weight: 700;
  margin: 0;
}

.how-it-works-hero__subtitle {
  margin: 0;
  font-size: 1.2rem;
  color: var(--color-text-secondary);
  max-width: 48ch;
}

.how-it-works-body {
  padding: 0 1.5rem 4rem;
  display: flex;
  justify-content: center;
}

.how-it-works-surface {
  width: min(960px, 100%);
  background-color: var(--color-bg-card);
  border-radius: 32px;
  border: 1px solid var(--color-border-base);
  padding: 3rem clamp(1.75rem, 3vw, 3rem);
  display: flex;
  flex-direction: column;
  gap: 2.5rem;
}

.how-it-works-content {
  display: flex;
  flex-direction: column;
  gap: 2.5rem;
  color: var(--color-text-primary);
  font-size: 1rem;
  line-height: 1.7;
}

.how-it-works-intro {
  font-size: 1.05rem;
  color: var(--color-text-secondary);
  padding: 1.5rem;
  background-color: var(--color-primary-bg);
  border: 1px solid var(--color-border-primary);
  border-radius: 16px;
  margin: 0;
}

.how-it-works-section {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.how-it-works-section h2 {
  font-size: 1.75rem;
  font-weight: 700;
  margin: 0;
  color: var(--color-text-primary);
  padding-bottom: 0.5rem;
  border-bottom: 2px solid var(--color-border-base);
}

.how-it-works-section h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin: 1.5rem 0 0.75rem;
  color: var(--color-text-primary);
}

.how-it-works-section p {
  margin: 0 0 1rem 0;
}

.how-it-works-section ul,
.how-it-works-section ol {
  margin: 0 0 1rem 1.5rem;
  padding-left: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.how-it-works-section ul li,
.how-it-works-section ol li {
  line-height: 1.7;
}

.how-it-works-section ul li strong,
.how-it-works-section ol li strong {
  color: var(--color-text-primary);
}

.how-it-works-section.highlight {
  background-color: var(--color-primary-bg);
  border: 1px solid var(--color-border-primary);
  border-radius: 16px;
  padding: 1.5rem;
}

.how-it-works-section a {
  color: var(--bulma-primary);
  text-decoration: none;
}

.how-it-works-section a:hover {
  text-decoration: underline;
}

.how-it-works-footer {
  display: flex;
  justify-content: center;
  padding-top: 1rem;
  border-top: 1px solid var(--color-border-base);
}

.fade-in {
  animation: fadeIn 1s ease-in-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: 768px) {
  .how-it-works-page {
    gap: 3rem;
  }

  .how-it-works-hero {
    padding: 4.5rem 1rem 3.5rem;
  }

  .how-it-works-surface {
    padding: 2.5rem 1.5rem;
  }

  .how-it-works-section h2 {
    font-size: 1.5rem;
  }

  .how-it-works-section h3 {
    font-size: 1.15rem;
  }
}
</style>

